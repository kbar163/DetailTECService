CREATE TABLE ROL
(
    ID_ROL INT NOT NULL PRIMARY KEY ,
    TIPO VARCHAR(20) NOT NULL ,

);

CREATE TABLE TIPO_PAGO
(
    ID_TIPO_PAGO INT NOT NULL PRIMARY KEY ,
    TIPO VARCHAR(20) NOT NULL ,

);

CREATE TABLE TRABAJADOR 
(
    CEDULA_TRABAJADOR VARCHAR(9) NOT NULL PRIMARY KEY ,
    FECHA_NACIMIENTO DATE NOT NULL ,
    NOMBRE VARCHAR(20) NOT NULL ,
    PRIMER_APELLIDO VARCHAR(20) NOT NULL ,
    SEGUNDO_APELLIDO VARCHAR(20) NOT NULL ,
    ID_ROL INT NOT NULL,
    ID_PAGO INT NOT NULL,
    FECHA_INGRESO DATE NOT NULL ,
    PASSWORD_TRABAJADOR VARCHAR(20) NOT NULL
);

CREATE TABLE SUCURSAL 
(
    NOMBRE_SUCURSAL VARCHAR(20) NOT NULL PRIMARY KEY ,
    TELEFONO VARCHAR(20) NOT NULL ,
    CEDULA_TRABAJADOR_GERENTE VARCHAR(9) NOT NULL ,
    PROVINCIA VARCHAR(20) NOT NULL ,
    CANTON VARCHAR(20) NOT NULL ,
    DISTRITO VARCHAR(20) NOT NULL ,
    FECHA_APERTURA DATE NOT NULL ,
    FECHA_INICIO_GERENCIA DATE NOT NULL
);

CREATE TABLE PROVEEDOR 
(
    CEDULA_JURIDICA_PROVEEDOR VARCHAR(20) NOT NULL PRIMARY KEY ,
    NOMBRE VARCHAR(20) NOT NULL ,
    CONTACTO VARCHAR(20) NOT NULL  ,
    PROVINCIA VARCHAR(20) NOT NULL ,
    CANTON VARCHAR(20) NOT NULL ,
    DISTRITO VARCHAR(20) NOT NULL ,
    CORREO_ELECTRONICO VARCHAR(50) NOT NULL
    
);

CREATE TABLE CLIENTE 
(
    CEDULA_CLIENTE VARCHAR(9) NOT NULL PRIMARY KEY ,
    NOMBRE VARCHAR(20) NOT NULL ,
    PRIMER_APELLIDO VARCHAR(20) NOT NULL ,
    SEGUNDO_APELLIDO VARCHAR(20) NOT NULL ,
    CORREO_CLIENTE VARCHAR(50) NOT NULL,
    USUARIO VARCHAR(20) NOT NULL,
    PASSWORD_CLIENTE VARCHAR(20) NOT NULL,
    PUNTOS_ACUM INT ,
    PUNTOS_OBT INT ,
    PUNTOS_REDIM INT ,
    CONSTRAINT UNIQUE_LOGIN UNIQUE (CORREO_CLIENTE,USUARIO)
    
);

CREATE TABLE CLIENTE_DIRECCION 
(
    CEDULA_CLIENTE VARCHAR(9) NOT NULL ,
    PROVINCIA VARCHAR(50) NOT NULL ,
    CANTON VARCHAR(50) NOT NULL ,
    DISTRITO VARCHAR(50) NOT NULL ,
    PRIMARY KEY (CEDULA_CLIENTE, PROVINCIA, CANTON, DISTRITO)
);

CREATE TABLE CLIENTE_TELEFONO 
(
    CEDULA_CLIENTE VARCHAR(9) NOT NULL ,
    TELEFONO VARCHAR(20) NOT NULL
);

CREATE TABLE INSUMO
(
    NOMBRE_INSUMO VARCHAR(50) NOT NULL PRIMARY KEY ,
    COSTO INT NOT NULL ,
    MARCA VARCHAR(20) NOT NULL ,
    CEDULA_JURIDICA_PROVEEDOR VARCHAR(20) NOT NULL

);

CREATE TABLE LAVADO
(
    NOMBRE_LAVADO VARCHAR(50) NOT NULL,
    COSTO_PERSONAL INT NOT NULL,
    PRECIO INT NOT NULL,
    DURACION INT NOT NULL,
    PUNTOS_OTORGADOS INT NOT NULL,
    COSTO_PUNTOS INT NOT NULL,
    PRIMARY KEY (NOMBRE_LAVADO)

);


CREATE TABLE LAVADO_INSUMO
(
    NOMBRE_LAVADO VARCHAR(50) NOT NULL ,
    NOMBRE_INSUMO VARCHAR(50) NOT NULL ,
    PRIMARY KEY (NOMBRE_LAVADO,NOMBRE_INSUMO)
 
);

CREATE TABLE LAVADO_ROL
(
    NOMBRE_LAVADO VARCHAR(50) NOT NULL ,
    ID_ROL INT NOT NULL, 
    PRIMARY KEY (NOMBRE_LAVADO,ID_ROL) 
);

CREATE TABLE CITA
(
    --ID_CITA VA A SER UN ID NUMERICO AUTOMATICO, SE INCREMENTA EN 1 CON CADA INSERCION.
    ID_CITA INT IDENTITY(1,1) NOT NULL,
    CEDULA_CLIENTE VARCHAR(9) NOT NULL,
    PLACA_VEHICULO VARCHAR(6) NOT NULL,
    NOMBRE_SUCURSAL VARCHAR(20) NOT NULL,
    NOMBRE_LAVADO VARCHAR(50) NOT NULL,
    CEDULA_TRABAJADOR VARCHAR(9) NOT NULL,
    HORA DATETIME NOT NULL,
    FACTURADA BIT NOT NULL,
    PRIMARY KEY (ID_CITA)

);

CREATE TABLE FACTURA
(
    --ID_FACTURA VA A SER UN ID NUMERICO AUTOMATICO, SE INCREMENTA EN 1 CON CADA INSERCION.
    ID_FACTURA INT IDENTITY(1,1) NOT NULL,
    CEDULA_CLIENTE VARCHAR(9) NOT NULL,
    ID_CITA INT NOT NULL,
    CANTIDAD_SNACKS INT NOT NULL,
    CANTIDAD_BEBIDAS INT NOT NULL,
    PAGO_PUNTOS BIT NOT NULL
    PRIMARY KEY (ID_FACTURA)

);

ALTER TABLE TRABAJADOR
ADD CONSTRAINT FK_ROL_TRABAJADOR
FOREIGN KEY (ID_ROL) REFERENCES ROL(ID_ROL);

ALTER TABLE TRABAJADOR
ADD CONSTRAINT FK_TIPOPAGO_TRABAJADOR
FOREIGN KEY (ID_PAGO) REFERENCES TIPO_PAGO(ID_TIPO_PAGO);

ALTER TABLE SUCURSAL
ADD CONSTRAINT FK_TRABAJADOR_SUCURSAL
FOREIGN KEY (CEDULA_TRABAJADOR_GERENTE) REFERENCES TRABAJADOR(CEDULA_TRABAJADOR);

ALTER TABLE CLIENTE_DIRECCION
ADD CONSTRAINT FK_CLIENTE_DIRECCION
FOREIGN KEY (CEDULA_CLIENTE) REFERENCES CLIENTE(CEDULA_CLIENTE);

ALTER TABLE CLIENTE_TELEFONO
ADD CONSTRAINT FK_CLIENTE_TELEFONO
FOREIGN KEY (CEDULA_CLIENTE) REFERENCES CLIENTE(CEDULA_CLIENTE);

ALTER TABLE INSUMO
ADD CONSTRAINT FK_PROVEEDOR_INSUMO
FOREIGN KEY (CEDULA_JURIDICA_PROVEEDOR) REFERENCES PROVEEDOR(CEDULA_JURIDICA_PROVEEDOR);

ALTER TABLE LAVADO_INSUMO
ADD CONSTRAINT FK_LAVADO_INSUMO_NL
FOREIGN KEY (NOMBRE_LAVADO) REFERENCES LAVADO(NOMBRE_LAVADO);

ALTER TABLE LAVADO_INSUMO
ADD CONSTRAINT FK_LAVADO_INSUMO_NI
FOREIGN KEY (NOMBRE_INSUMO) REFERENCES INSUMO(NOMBRE_INSUMO);

ALTER TABLE LAVADO_ROL
ADD CONSTRAINT FK_LAVADO_ROL_NL
FOREIGN KEY (NOMBRE_LAVADO) REFERENCES LAVADO(NOMBRE_LAVADO);

ALTER TABLE LAVADO_ROL
ADD CONSTRAINT FK_LAVADO_ROL_IR
FOREIGN KEY (ID_ROL) REFERENCES ROL(ID_ROL);

ALTER TABLE CLIENTE
ADD CONSTRAINT NON_NEGATIVE_ACUM
CHECK (PUNTOS_ACUM >= 0);

ALTER TABLE CLIENTE
ADD CONSTRAINT NON_NEGATIVE_OBT
CHECK (PUNTOS_OBT >= 0);

ALTER TABLE CLIENTE
ADD CONSTRAINT NON_NEGATIVE_REDIM
CHECK (PUNTOS_REDIM >= 0);

ALTER TABLE FACTURA
ADD CONSTRAINT FK_FACTURA_CEDULA_CLIENTE
FOREIGN KEY (CEDULA_CLIENTE) REFERENCES CLIENTE(CEDULA_CLIENTE);

ALTER TABLE FACTURA
ADD CONSTRAINT FK_FACTURA_ID_CITA
FOREIGN KEY (ID_CITA) REFERENCES CITA(ID_CITA);

ALTER TABLE CITA
ADD CONSTRAINT FK_CITA_CEDULA_CLIENTE
FOREIGN KEY (CEDULA_CLIENTE) REFERENCES CLIENTE(CEDULA_CLIENTE);

ALTER TABLE CITA
ADD CONSTRAINT FK_CITA_NOMBRE_SUCURSAL
FOREIGN KEY (NOMBRE_SUCURSAL) REFERENCES SUCURSAL(NOMBRE_SUCURSAL);

ALTER TABLE CITA
ADD CONSTRAINT FK_CITA_NOMBRE_LAVADO
FOREIGN KEY (NOMBRE_LAVADO) REFERENCES LAVADO(NOMBRE_LAVADO);

ALTER TABLE CITA
ADD CONSTRAINT FK_CITA_CEDULA_TRABAJADOR
FOREIGN KEY (CEDULA_TRABAJADOR) REFERENCES TRABAJADOR(CEDULA_TRABAJADOR);